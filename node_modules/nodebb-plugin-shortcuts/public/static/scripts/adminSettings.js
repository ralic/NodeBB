/*
 * This files gets called from the admin-page of the module to handle settings.
 *
 * Files within the public/static/scripts/ directory get meta-replaced by default (thus @{...} gets resolved within the
 * grunt-tasks).
 */
!function(){"use strict";var a="shortcuts",b=$("#"+a+"-settings"),c=$("#"+a+"-actions"),d=$("#"+a+"-admin-actions");socket.emit("admin.settings.getShortcutsDefaults",null,function(e,f){return null!=e?app.alert({alert_id:"config_status",timeout:2500,type:"danger",title:"Settings Not Found",message:"Your plugin-settings have not been found."}):void require(["plugin/shortcuts/debug","settings","translator"],function(e,g,h){/*======================================= Dynamically insert action inputs =======================================*/
function i(a){return"-"+a.toLowerCase()}function j(b,c,d){var e=$('<div class="form-group"></div>'),f=$('<label class="col-xs-12 col-sm-5 control-label" for="'+d+'"></label>').appendTo(e);h.translate("[["+a+":"+c+"]]",function(a){f.text(a)});var g=$('<div id="'+d+'" data-key="'+b+'"></div>').data({attributes:{"class":"form-control",type:"key"},split:" "});return e.append(f).append($('<div class="col-xs-12 col-sm-7"></div>').append(g))}function k(b,c,d,e,f){var g,h,l,m;for(var n in c)c.hasOwnProperty(n)&&(g=c[n],h=f+"-"+n,l=d+"."+n,m=e+"."+n,"object"!=typeof g||g instanceof Array?("string"==typeof g&&(g=[g]),g instanceof Array&&j(l,m,a+"-"+h.replace(/[A-Z]/g,i)).appendTo(b)):k(b,g,l,m,h))}function l(b,c,d,e){var f=$('<div class="col-xs-12 col-sm-6"></div>'),g=$("<h3></h3>").appendTo(f);return h.translate("[["+a+":actions."+b+"]]",function(a){g.text(a)}),k(f,c,d+"."+b,e+"."+b,"action"),f}function m(a,b,c,d){for(var e in b)b.hasOwnProperty(e)&&l(e,b[e],c,d).appendTo(a)}m(c,f._.actions,"actions","actions"),m(d,f._.adminActions,"adminActions","actions"),/*========================================= Handle settings and buttons  =========================================*/
// synchronize settings
g.sync(a,b),b.find("."+a+"-settings-save").click(function(c){c.preventDefault(),g.persist(a,b,function(){e.enabled&&e._log(a,g.cfg._),socket.emit("admin.settings.syncShortcuts")})}).removeAttr("disabled"),b.find("."+a+"-settings-reset").click(function(c){c.preventDefault(),g.sync(a,b)}).removeAttr("disabled"),b.find("."+a+"-settings-purge").click(function(c){c.preventDefault(),socket.emit("admin.settings.getShortcutsDefaults",null,function(c,d){g.set(a,d,b,function(){socket.emit("admin.settings.syncShortcuts")})})}).removeAttr("disabled")})})}();