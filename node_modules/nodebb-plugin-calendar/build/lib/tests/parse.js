'use strict';

var _parse = require('../parse');

var _parse2 = _interopRequireDefault(_parse);

var _assert = require('assert');

var _assert2 = _interopRequireDefault(_assert);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const setEquals = (a, b) => {
  if (a.length !== b.length) {
    return false;
  }
  for (const x of a) {
    let found = false;
    for (const y of b) {
      if (x === y) {
        found = true;
        break;
      }
    }
    if (!found) {
      return false;
    }
  }
  return true;
};

[() => {
  // basic test
  const data = {
    name: 'a test name',
    allday: true,
    startDate: Date.now() - 3 * 24 * 60 * 60 * 1000,
    endDate: Date.now(),
    reminders: [0, 10, 20, 50],
    location: 'here somewhere',
    description: 'somewhere else'
  };
  const result = (0, _parse2.default)(`other things that make sense
      [event]
        [name]${ data.name }[/name]
        [allday]${ data.allday }[/allday]
        [startDate]${ data.startDate }[/startDate]
        [endDate]${ data.endDate }[/endDate]
        [reminders]${ JSON.stringify(data.reminders) }[/reminders]
        [location]${ data.location }[/location]
        [description]
          ${ data.description }
        [/description]
      [/event]
      and some more *markdown*`);

  (0, _assert2.default)(result && typeof result === 'object', 'Expected Object, got a falsy value');
  _assert2.default.strictEqual(data.name, result.name, '`name` field incorrect');
  _assert2.default.strictEqual(data.allday, result.allday, '`allday` field incorrect');
  _assert2.default.strictEqual(data.startDate, result.startDate, '`startDate` field incorrect');
  _assert2.default.strictEqual(data.endDate, result.endDate, '`endDate` field incorrect');
  (0, _assert2.default)(setEquals(data.reminders, result.reminders), '`reminders` field incorrect');
  _assert2.default.strictEqual(data.location, result.location, '`location` field incorrect');
  _assert2.default.strictEqual(data.description, result.description, '`description` field incorrect');
}, () => {
  // test allday false
  const data = {
    name: 'a test name',
    allday: false,
    startDate: Date.now() - 3 * 24 * 60 * 60 * 1000,
    endDate: Date.now(),
    reminders: [0, 10, 20, 50],
    location: 'here somewhere',
    description: 'somewhere else'
  };
  const result = (0, _parse2.default)(`[event]
        [name]${ data.name }[/name]
        [allday]${ data.allday }[/allday]
        [startDate]${ data.startDate }[/startDate]
        [endDate]${ data.endDate }[/endDate]
        [reminders]${ JSON.stringify(data.reminders) }[/reminders]
        [location]${ data.location }[/location]
        [description]
          ${ data.description }
        [/description]
      [/event]`);
  (0, _assert2.default)(result && typeof result === 'object', 'Expected Object, got a falsy value');
  _assert2.default.strictEqual(data.name, result.name, '`name` field incorrect');
  _assert2.default.strictEqual(data.allday, result.allday, '`allday` field incorrect');
  _assert2.default.strictEqual(data.startDate, result.startDate, '`startDate` field incorrect');
  _assert2.default.strictEqual(data.endDate, result.endDate, '`endDate` field incorrect');
  (0, _assert2.default)(setEquals(data.reminders, result.reminders), '`reminders` field incorrect');
  _assert2.default.strictEqual(data.location, result.location, '`location` field incorrect');
  _assert2.default.strictEqual(data.description, result.description, '`description` field incorrect');
}, () => {
  // test bad date failing completely
  const data = {
    name: 'a test name',
    allday: false,
    startDate: Date.now() - 3 * 24 * 60 * 60 * 1000,
    endDate: 'a string',
    reminders: [0, 10, 20, 50],
    location: 'here somewhere',
    description: 'somewhere else'
  };
  const result = (0, _parse2.default)(`[event]
        [name]${ data.name }[/name]
        [allday]${ data.allday }[/allday]
        [startDate]${ data.startDate }[/startDate]
        [endDate]${ data.endDate }[/endDate]
        [reminders]${ JSON.stringify(data.reminders) }[/reminders]
        [location]${ data.location }[/location]
        [description]
          ${ data.description }
        [/description]
      [/event]`);
  _assert2.default.strictEqual(null, result, 'Expected null, got something else');
}, () => {
  // test bad reminders failing completely
  const data = {
    name: 'a test name',
    allday: false,
    startDate: Date.now() - 3 * 24 * 60 * 60 * 1000,
    endDate: Date.now(),
    reminders: 'a string',
    location: 'here somewhere',
    description: 'somewhere else'
  };
  const result = (0, _parse2.default)(`[event]
        [name]${ data.name }[/name]
        [allday]${ data.allday }[/allday]
        [startDate]${ data.startDate }[/startDate]
        [endDate]${ data.endDate }[/endDate]
        [reminders]${ JSON.stringify(data.reminders) }[/reminders]
        [location]${ data.location }[/location]
        [description]
          ${ data.description }
        [/description]
      [/event]`);
  _assert2.default.strictEqual(null, result, 'Expected null, got something else');
}, () => {
  // test bad location failing completely
  const data = {
    name: 'a test name',
    allday: false,
    startDate: Date.now() - 3 * 24 * 60 * 60 * 1000,
    endDate: Date.now(),
    reminders: [0, 10, 20, 50],
    location: 'here somewhere\nhasbbks',
    description: 'somewhere else'
  };
  const result = (0, _parse2.default)(`[event]
        [name]${ data.name }[/name]
        [allday]${ data.allday }[/allday]
        [startDate]${ data.startDate }[/startDate]
        [endDate]${ data.endDate }[/endDate]
        [reminders]${ JSON.stringify(data.reminders) }[/reminders]
        [location]${ data.location }[/location]
        [description]
          ${ data.description }
        [/description]
      [/event]`);
  _assert2.default.strictEqual(null, result, 'Expected null, got something else');
}, () => {
  // test bad name failing completely
  const data = {
    name: 'a test name\ndsjvhoaho',
    allday: false,
    startDate: Date.now() - 3 * 24 * 60 * 60 * 1000,
    endDate: Date.now(),
    reminders: [0, 10, 20, 50],
    location: 'here somewhere',
    description: 'somewhere else'
  };
  const result = (0, _parse2.default)(`[event]
        [name]${ data.name }[/name]
        [allday]${ data.allday }[/allday]
        [startDate]${ data.startDate }[/startDate]
        [endDate]${ data.endDate }[/endDate]
        [reminders]${ JSON.stringify(data.reminders) }[/reminders]
        [location]${ data.location }[/location]
        [description]
          ${ data.description }
        [/description]
      [/event]`);
  _assert2.default.strictEqual(null, result, 'Expected null, got something else');
}].forEach(x => x());
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9saWIvdGVzdHMvcGFyc2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7OztBQUNBOzs7Ozs7QUFFQSxNQUFNLFlBQVksQ0FBQyxDQUFELEVBQUksQ0FBSixLQUFVO0FBQzFCLE1BQUksRUFBRSxNQUFGLEtBQWEsRUFBRSxNQUFuQixFQUEyQjtBQUN6QixXQUFPLEtBQVA7QUFDRDtBQUNELE9BQUssTUFBTSxDQUFYLElBQWdCLENBQWhCLEVBQW1CO0FBQ2pCLFFBQUksUUFBUSxLQUFaO0FBQ0EsU0FBSyxNQUFNLENBQVgsSUFBZ0IsQ0FBaEIsRUFBbUI7QUFDakIsVUFBSSxNQUFNLENBQVYsRUFBYTtBQUNYLGdCQUFRLElBQVI7QUFDQTtBQUNEO0FBQ0Y7QUFDRCxRQUFJLENBQUMsS0FBTCxFQUFZO0FBQ1YsYUFBTyxLQUFQO0FBQ0Q7QUFDRjtBQUNELFNBQU8sSUFBUDtBQUNELENBakJEOztBQW1CQSxDQUNFLE1BQU07O0FBRUosUUFBTSxPQUFPO0FBQ1gsVUFBTSxhQURLO0FBRVgsWUFBUSxJQUZHO0FBR1gsZUFBVyxLQUFLLEdBQUwsS0FBYSxJQUFJLEVBQUosR0FBUyxFQUFULEdBQWMsRUFBZCxHQUFtQixJQUhoQztBQUlYLGFBQVMsS0FBSyxHQUFMLEVBSkU7QUFLWCxlQUFXLENBQUMsQ0FBRCxFQUFJLEVBQUosRUFBUSxFQUFSLEVBQVksRUFBWixDQUxBO0FBTVgsY0FBVSxnQkFOQztBQU9YLGlCQUFhO0FBUEYsR0FBYjtBQVNBLFFBQU0sU0FBUyxxQkFDWjs7Z0JBQUEsQ0FFUyxLQUFLLElBQUs7a0JBQUEsQ0FDUixLQUFLLE1BQU87cUJBQUEsQ0FDVCxLQUFLLFNBQVU7bUJBQUEsQ0FDakIsS0FBSyxPQUFRO3FCQUFBLENBQ1gsS0FBSyxTQUFMLENBQWUsS0FBSyxTQUFwQixDQUErQjtvQkFBQSxDQUNoQyxLQUFLLFFBQVM7O1lBQUEsQ0FFdEIsS0FBSyxXQUFZOzs7K0JBVlYsQ0FBZjs7QUFnQkEsd0JB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SyxNQUFPO3FCQUFBLENBQ1QsS0FBSyxTQUFVO21CQUFBLENBQ2pCLEtBQUssT0FBUTtxQkFBQSxDQUNYLEtBQUssU0FBTCxDQUFlLEtBQUssU0FBcEIsQ0FBK0I7b0JBQUEsQ0FDaEMsS0FBSyxRQUFTOztZQUFBLENBRXRCLEtBQUssV0FBWTs7ZUFUVixDQUFmO0FBYUEsbUJBQU8sV0FBUCxDQUFtQixJQUFuQixFQUF5QixNQUF6QixFQUFpQyxtQ0FBakM7QUFDRCxDQXJKSCxFQXNKRSxNQUFNOztBQUVKLFFBQU0sT0FBTztBQUNYLFVBQU0sd0JBREs7QUFFWCxZQUFRLEtBRkc7QUFHWCxlQUFXLEtBQUssR0FBTCxLQUFhLElBQUksRUFBSixHQUFTLEVBQVQsR0FBYyxFQUFkLEdBQW1CLElBSGhDO0FBSVgsYUFBUyxLQUFLLEdBQUwsRUFKRTtBQUtYLGVBQVcsQ0FBQyxDQUFELEVBQUksRUFBSixFQUFRLEVBQVIsRUFBWSxFQUFaLENBTEE7QUFNWCxjQUFVLGdCQU5DO0FBT1gsaUJBQWE7QUFQRixHQUFiO0FBU0EsUUFBTSxTQUFTLHFCQUNaO2dCQUFBLENBQ1MsS0FBSyxJQUFLO2tCQUFBLENBQ1IsS0FBSyxNQUFPO3FCQUFBLENBQ1QsS0FBSyxTQUFVO21CQUFBLENBQ2pCLEtBQUssT0FBUTtxQkFBQSxDQUNYLEtBQUssU0FBTCxDQUFlLEtBQUssU0FBcEIsQ0FBK0I7b0JBQUEsQ0FDaEMsS0FBSyxRQUFTOztZQUFBLENBRXRCLEtBQUssV0FBWTs7ZUFUVixDQUFmO0FBYUEsbUJBQU8sV0FBUCxDQUFtQixJQUFuQixFQUF5QixNQUF6QixFQUFpQyxtQ0FBakM7QUFDRCxDQS9LSCxFQWdMRSxPQWhMRixDQWdMVSxLQUFLLEdBaExmIiwiZmlsZSI6InBhcnNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhcnNlIGZyb20gJy4uL3BhcnNlJztcbmltcG9ydCBhc3NlcnQgZnJvbSAnYXNzZXJ0JztcblxuY29uc3Qgc2V0RXF1YWxzID0gKGEsIGIpID0+IHtcbiAgaWYgKGEubGVuZ3RoICE9PSBiLmxlbmd0aCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBmb3IgKGNvbnN0IHggb2YgYSkge1xuICAgIGxldCBmb3VuZCA9IGZhbHNlO1xuICAgIGZvciAoY29uc3QgeSBvZiBiKSB7XG4gICAgICBpZiAoeCA9PT0geSkge1xuICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWZvdW5kKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufTtcblxuW1xuICAoKSA9PiB7XG4gICAgLy8gYmFzaWMgdGVzdFxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBuYW1lOiAnYSB0ZXN0IG5hbWUnLFxuICAgICAgYWxsZGF5OiB0cnVlLFxuICAgICAgc3RhcnREYXRlOiBEYXRlLm5vdygpIC0gMyAqIDI0ICogNjAgKiA2MCAqIDEwMDAsXG4gICAgICBlbmREYXRlOiBEYXRlLm5vdygpLFxuICAgICAgcmVtaW5kZXJzOiBbMCwgMTAsIDIwLCA1MF0sXG4gICAgICBsb2NhdGlvbjogJ2hlcmUgc29tZXdoZXJlJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnc29tZXdoZXJlIGVsc2UnLFxuICAgIH07XG4gICAgY29uc3QgcmVzdWx0ID0gcGFyc2UoXG4gICAgICBgb3RoZXIgdGhpbmdzIHRoYXQgbWFrZSBzZW5zZVxuICAgICAgW2V2ZW50XVxuICAgICAgICBbbmFtZV0ke2RhdGEubmFtZX1bL25hbWVdXG4gICAgICAgIFthbGxkYXldJHtkYXRhLmFsbGRheX1bL2FsbGRheV1cbiAgICAgICAgW3N0YXJ0RGF0ZV0ke2RhdGEuc3RhcnREYXRlfVsvc3RhcnREYXRlXVxuICAgICAgICBbZW5kRGF0ZV0ke2RhdGEuZW5kRGF0ZX1bL2VuZERhdGVdXG4gICAgICAgIFtyZW1pbmRlcnNdJHtKU09OLnN0cmluZ2lmeShkYXRhLnJlbWluZGVycyl9Wy9yZW1pbmRlcnNdXG4gICAgICAgIFtsb2NhdGlvbl0ke2RhdGEubG9jYXRpb259Wy9sb2NhdGlvbl1cbiAgICAgICAgW2Rlc2NyaXB0aW9uXVxuICAgICAgICAgICR7ZGF0YS5kZXNjcmlwdGlvbn1cbiAgICAgICAgWy9kZXNjcmlwdGlvbl1cbiAgICAgIFsvZXZlbnRdXG4gICAgICBhbmQgc29tZSBtb3JlICptYXJrZG93bipgXG4gICAgKTtcblxuICAgIGFzc2VydChyZXN1bHQgJiYgdHlwZW9mIHJlc3VsdCA9PT0gJ29iamVjdCcsICdFeHBlY3RlZCBPYmplY3QsIGdvdCBhIGZhbHN5IHZhbHVlJyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEubmFtZSwgcmVzdWx0Lm5hbWUsICdgbmFtZWAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEuYWxsZGF5LCByZXN1bHQuYWxsZGF5LCAnYGFsbGRheWAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEuc3RhcnREYXRlLCByZXN1bHQuc3RhcnREYXRlLCAnYHN0YXJ0RGF0ZWAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEuZW5kRGF0ZSwgcmVzdWx0LmVuZERhdGUsICdgZW5kRGF0ZWAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0KHNldEVxdWFscyhkYXRhLnJlbWluZGVycywgcmVzdWx0LnJlbWluZGVycyksXG4gICAgICAnYHJlbWluZGVyc2AgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEubG9jYXRpb24sIHJlc3VsdC5sb2NhdGlvbiwgJ2Bsb2NhdGlvbmAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEuZGVzY3JpcHRpb24sIHJlc3VsdC5kZXNjcmlwdGlvbiwgJ2BkZXNjcmlwdGlvbmAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gIH0sXG4gICgpID0+IHtcbiAgICAvLyB0ZXN0IGFsbGRheSBmYWxzZVxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBuYW1lOiAnYSB0ZXN0IG5hbWUnLFxuICAgICAgYWxsZGF5OiBmYWxzZSxcbiAgICAgIHN0YXJ0RGF0ZTogRGF0ZS5ub3coKSAtIDMgKiAyNCAqIDYwICogNjAgKiAxMDAwLFxuICAgICAgZW5kRGF0ZTogRGF0ZS5ub3coKSxcbiAgICAgIHJlbWluZGVyczogWzAsIDEwLCAyMCwgNTBdLFxuICAgICAgbG9jYXRpb246ICdoZXJlIHNvbWV3aGVyZScsXG4gICAgICBkZXNjcmlwdGlvbjogJ3NvbWV3aGVyZSBlbHNlJyxcbiAgICB9O1xuICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlKFxuICAgICAgYFtldmVudF1cbiAgICAgICAgW25hbWVdJHtkYXRhLm5hbWV9Wy9uYW1lXVxuICAgICAgICBbYWxsZGF5XSR7ZGF0YS5hbGxkYXl9Wy9hbGxkYXldXG4gICAgICAgIFtzdGFydERhdGVdJHtkYXRhLnN0YXJ0RGF0ZX1bL3N0YXJ0RGF0ZV1cbiAgICAgICAgW2VuZERhdGVdJHtkYXRhLmVuZERhdGV9Wy9lbmREYXRlXVxuICAgICAgICBbcmVtaW5kZXJzXSR7SlNPTi5zdHJpbmdpZnkoZGF0YS5yZW1pbmRlcnMpfVsvcmVtaW5kZXJzXVxuICAgICAgICBbbG9jYXRpb25dJHtkYXRhLmxvY2F0aW9ufVsvbG9jYXRpb25dXG4gICAgICAgIFtkZXNjcmlwdGlvbl1cbiAgICAgICAgICAke2RhdGEuZGVzY3JpcHRpb259XG4gICAgICAgIFsvZGVzY3JpcHRpb25dXG4gICAgICBbL2V2ZW50XWBcbiAgICApO1xuICAgIGFzc2VydChyZXN1bHQgJiYgdHlwZW9mIHJlc3VsdCA9PT0gJ29iamVjdCcsICdFeHBlY3RlZCBPYmplY3QsIGdvdCBhIGZhbHN5IHZhbHVlJyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEubmFtZSwgcmVzdWx0Lm5hbWUsICdgbmFtZWAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEuYWxsZGF5LCByZXN1bHQuYWxsZGF5LCAnYGFsbGRheWAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEuc3RhcnREYXRlLCByZXN1bHQuc3RhcnREYXRlLCAnYHN0YXJ0RGF0ZWAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEuZW5kRGF0ZSwgcmVzdWx0LmVuZERhdGUsICdgZW5kRGF0ZWAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0KHNldEVxdWFscyhkYXRhLnJlbWluZGVycywgcmVzdWx0LnJlbWluZGVycyksXG4gICAgICAnYHJlbWluZGVyc2AgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEubG9jYXRpb24sIHJlc3VsdC5sb2NhdGlvbiwgJ2Bsb2NhdGlvbmAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGRhdGEuZGVzY3JpcHRpb24sIHJlc3VsdC5kZXNjcmlwdGlvbiwgJ2BkZXNjcmlwdGlvbmAgZmllbGQgaW5jb3JyZWN0Jyk7XG4gIH0sXG4gICgpID0+IHtcbiAgICAvLyB0ZXN0IGJhZCBkYXRlIGZhaWxpbmcgY29tcGxldGVseVxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBuYW1lOiAnYSB0ZXN0IG5hbWUnLFxuICAgICAgYWxsZGF5OiBmYWxzZSxcbiAgICAgIHN0YXJ0RGF0ZTogRGF0ZS5ub3coKSAtIDMgKiAyNCAqIDYwICogNjAgKiAxMDAwLFxuICAgICAgZW5kRGF0ZTogJ2Egc3RyaW5nJyxcbiAgICAgIHJlbWluZGVyczogWzAsIDEwLCAyMCwgNTBdLFxuICAgICAgbG9jYXRpb246ICdoZXJlIHNvbWV3aGVyZScsXG4gICAgICBkZXNjcmlwdGlvbjogJ3NvbWV3aGVyZSBlbHNlJyxcbiAgICB9O1xuICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlKFxuICAgICAgYFtldmVudF1cbiAgICAgICAgW25hbWVdJHtkYXRhLm5hbWV9Wy9uYW1lXVxuICAgICAgICBbYWxsZGF5XSR7ZGF0YS5hbGxkYXl9Wy9hbGxkYXldXG4gICAgICAgIFtzdGFydERhdGVdJHtkYXRhLnN0YXJ0RGF0ZX1bL3N0YXJ0RGF0ZV1cbiAgICAgICAgW2VuZERhdGVdJHtkYXRhLmVuZERhdGV9Wy9lbmREYXRlXVxuICAgICAgICBbcmVtaW5kZXJzXSR7SlNPTi5zdHJpbmdpZnkoZGF0YS5yZW1pbmRlcnMpfVsvcmVtaW5kZXJzXVxuICAgICAgICBbbG9jYXRpb25dJHtkYXRhLmxvY2F0aW9ufVsvbG9jYXRpb25dXG4gICAgICAgIFtkZXNjcmlwdGlvbl1cbiAgICAgICAgICAke2RhdGEuZGVzY3JpcHRpb259XG4gICAgICAgIFsvZGVzY3JpcHRpb25dXG4gICAgICBbL2V2ZW50XWBcbiAgICApO1xuICAgIGFzc2VydC5zdHJpY3RFcXVhbChudWxsLCByZXN1bHQsICdFeHBlY3RlZCBudWxsLCBnb3Qgc29tZXRoaW5nIGVsc2UnKTtcbiAgfSxcbiAgKCkgPT4ge1xuICAgIC8vIHRlc3QgYmFkIHJlbWluZGVycyBmYWlsaW5nIGNvbXBsZXRlbHlcbiAgICBjb25zdCBkYXRhID0ge1xuICAgICAgbmFtZTogJ2EgdGVzdCBuYW1lJyxcbiAgICAgIGFsbGRheTogZmFsc2UsXG4gICAgICBzdGFydERhdGU6IERhdGUubm93KCkgLSAzICogMjQgKiA2MCAqIDYwICogMTAwMCxcbiAgICAgIGVuZERhdGU6IERhdGUubm93KCksXG4gICAgICByZW1pbmRlcnM6ICdhIHN0cmluZycsXG4gICAgICBsb2NhdGlvbjogJ2hlcmUgc29tZXdoZXJlJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnc29tZXdoZXJlIGVsc2UnLFxuICAgIH07XG4gICAgY29uc3QgcmVzdWx0ID0gcGFyc2UoXG4gICAgICBgW2V2ZW50XVxuICAgICAgICBbbmFtZV0ke2RhdGEubmFtZX1bL25hbWVdXG4gICAgICAgIFthbGxkYXldJHtkYXRhLmFsbGRheX1bL2FsbGRheV1cbiAgICAgICAgW3N0YXJ0RGF0ZV0ke2RhdGEuc3RhcnREYXRlfVsvc3RhcnREYXRlXVxuICAgICAgICBbZW5kRGF0ZV0ke2RhdGEuZW5kRGF0ZX1bL2VuZERhdGVdXG4gICAgICAgIFtyZW1pbmRlcnNdJHtKU09OLnN0cmluZ2lmeShkYXRhLnJlbWluZGVycyl9Wy9yZW1pbmRlcnNdXG4gICAgICAgIFtsb2NhdGlvbl0ke2RhdGEubG9jYXRpb259Wy9sb2NhdGlvbl1cbiAgICAgICAgW2Rlc2NyaXB0aW9uXVxuICAgICAgICAgICR7ZGF0YS5kZXNjcmlwdGlvbn1cbiAgICAgICAgWy9kZXNjcmlwdGlvbl1cbiAgICAgIFsvZXZlbnRdYFxuICAgICk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKG51bGwsIHJlc3VsdCwgJ0V4cGVjdGVkIG51bGwsIGdvdCBzb21ldGhpbmcgZWxzZScpO1xuICB9LFxuICAoKSA9PiB7XG4gICAgLy8gdGVzdCBiYWQgbG9jYXRpb24gZmFpbGluZyBjb21wbGV0ZWx5XG4gICAgY29uc3QgZGF0YSA9IHtcbiAgICAgIG5hbWU6ICdhIHRlc3QgbmFtZScsXG4gICAgICBhbGxkYXk6IGZhbHNlLFxuICAgICAgc3RhcnREYXRlOiBEYXRlLm5vdygpIC0gMyAqIDI0ICogNjAgKiA2MCAqIDEwMDAsXG4gICAgICBlbmREYXRlOiBEYXRlLm5vdygpLFxuICAgICAgcmVtaW5kZXJzOiBbMCwgMTAsIDIwLCA1MF0sXG4gICAgICBsb2NhdGlvbjogJ2hlcmUgc29tZXdoZXJlXFxuaGFzYmJrcycsXG4gICAgICBkZXNjcmlwdGlvbjogJ3NvbWV3aGVyZSBlbHNlJyxcbiAgICB9O1xuICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlKFxuICAgICAgYFtldmVudF1cbiAgICAgICAgW25hbWVdJHtkYXRhLm5hbWV9Wy9uYW1lXVxuICAgICAgICBbYWxsZGF5XSR7ZGF0YS5hbGxkYXl9Wy9hbGxkYXldXG4gICAgICAgIFtzdGFydERhdGVdJHtkYXRhLnN0YXJ0RGF0ZX1bL3N0YXJ0RGF0ZV1cbiAgICAgICAgW2VuZERhdGVdJHtkYXRhLmVuZERhdGV9Wy9lbmREYXRlXVxuICAgICAgICBbcmVtaW5kZXJzXSR7SlNPTi5zdHJpbmdpZnkoZGF0YS5yZW1pbmRlcnMpfVsvcmVtaW5kZXJzXVxuICAgICAgICBbbG9jYXRpb25dJHtkYXRhLmxvY2F0aW9ufVsvbG9jYXRpb25dXG4gICAgICAgIFtkZXNjcmlwdGlvbl1cbiAgICAgICAgICAke2RhdGEuZGVzY3JpcHRpb259XG4gICAgICAgIFsvZGVzY3JpcHRpb25dXG4gICAgICBbL2V2ZW50XWBcbiAgICApO1xuICAgIGFzc2VydC5zdHJpY3RFcXVhbChudWxsLCByZXN1bHQsICdFeHBlY3RlZCBudWxsLCBnb3Qgc29tZXRoaW5nIGVsc2UnKTtcbiAgfSxcbiAgKCkgPT4ge1xuICAgIC8vIHRlc3QgYmFkIG5hbWUgZmFpbGluZyBjb21wbGV0ZWx5XG4gICAgY29uc3QgZGF0YSA9IHtcbiAgICAgIG5hbWU6ICdhIHRlc3QgbmFtZVxcbmRzanZob2FobycsXG4gICAgICBhbGxkYXk6IGZhbHNlLFxuICAgICAgc3RhcnREYXRlOiBEYXRlLm5vdygpIC0gMyAqIDI0ICogNjAgKiA2MCAqIDEwMDAsXG4gICAgICBlbmREYXRlOiBEYXRlLm5vdygpLFxuICAgICAgcmVtaW5kZXJzOiBbMCwgMTAsIDIwLCA1MF0sXG4gICAgICBsb2NhdGlvbjogJ2hlcmUgc29tZXdoZXJlJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnc29tZXdoZXJlIGVsc2UnLFxuICAgIH07XG4gICAgY29uc3QgcmVzdWx0ID0gcGFyc2UoXG4gICAgICBgW2V2ZW50XVxuICAgICAgICBbbmFtZV0ke2RhdGEubmFtZX1bL25hbWVdXG4gICAgICAgIFthbGxkYXldJHtkYXRhLmFsbGRheX1bL2FsbGRheV1cbiAgICAgICAgW3N0YXJ0RGF0ZV0ke2RhdGEuc3RhcnREYXRlfVsvc3RhcnREYXRlXVxuICAgICAgICBbZW5kRGF0ZV0ke2RhdGEuZW5kRGF0ZX1bL2VuZERhdGVdXG4gICAgICAgIFtyZW1pbmRlcnNdJHtKU09OLnN0cmluZ2lmeShkYXRhLnJlbWluZGVycyl9Wy9yZW1pbmRlcnNdXG4gICAgICAgIFtsb2NhdGlvbl0ke2RhdGEubG9jYXRpb259Wy9sb2NhdGlvbl1cbiAgICAgICAgW2Rlc2NyaXB0aW9uXVxuICAgICAgICAgICR7ZGF0YS5kZXNjcmlwdGlvbn1cbiAgICAgICAgWy9kZXNjcmlwdGlvbl1cbiAgICAgIFsvZXZlbnRdYFxuICAgICk7XG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKG51bGwsIHJlc3VsdCwgJ0V4cGVjdGVkIG51bGwsIGdvdCBzb21ldGhpbmcgZWxzZScpO1xuICB9LFxuXS5mb3JFYWNoKHggPT4geCgpKTtcbiJdfQ==